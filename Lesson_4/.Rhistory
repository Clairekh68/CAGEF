dat$publisher <- str_replace_all(dat$publisher, "british medical journal", "bmj")
dat$publisher <- str_replace_all(dat$publisher, ".*american society of microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "of general microbiology", "for general microbiology")
dat$publisher <- str_replace_all(dat$publisher, "of leukocyte", "for leukocyte")
dat$publisher <- str_replace_all(dat$publisher, "publisher society", "society")
dat$publisher <- str_replace_all(dat$publisher, "company of biologist[^s]", "company of biologists")
dat$publisher <- str_replace_all(dat$publisher, "american psychiatric publishing", "american psychiatric association")
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), sd = sd(cost), n=n()) %>% arrange(desc(mean))
dat$publisher <- str_remove_all(dat$publisher, "\r\n")
dat$publisher <- str_trim(dat$publisher, side = "both")
dat$publisher <- str_remove_all(dat$publisher, "the ")
library(tidyverse)
library(readxl)
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx")
str(dat)
colnames(dat) <- gsub("/", "_", colnames(dat))
colnames(dat) <- gsub(" .*", "", colnames(dat))
colnames(dat) <-tolower(colnames(dat))
dat %>% arrange(desc(cost)) %>% head()
dat %>% summary(cost)
dat[!complete.cases(dat$journal),]
dat[!complete.cases(dat),]
dat <- dat %>% filter(journal != "NA")
dat %>% arrange(cost) %>% filter(publisher == "American Society for Nutrition")
dat %>% summarize(sd = sd(cost), mean = mean(cost))
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- tolower(dat$publisher)
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- str_replace_all(dat$publisher, "darmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "wliey.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, "endrocrine", "endocrine")
dat$publisher <- str_replace_all(dat$publisher, "biolgists", "biologists")
dat$publisher <- str_replace_all(dat$publisher, "socety", "society")
dat$publisher <- str_replace_all(dat$publisher, "genermal", "general")
dat$publisher <- str_replace_all(dat$publisher, "neuro\\s?science[s]?", "neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "elseveier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, "of neuroscience", "for neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "habour", "harbor")
dat$publisher <- str_replace_all(dat$publisher, "landes biosciences", "landes bioscience")
dat$publisher <- str_replace_all(dat$publisher, "biolgy", "biology")
dat$publisher <- str_replace_all(dat$publisher, "soc\\b", "society")
dat$publisher <- str_replace_all(dat$publisher, "hamatology|haematology", "hematology")
dat$publisher <- str_replace_all(dat$publisher, "cadmus", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "benthan", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "berhahn books", "berghahn")
dat$publisher <- str_replace_all(dat$publisher, "byophysical", "biophysical")
dat$publisher <- str_replace_all(dat$publisher, "asbmc.*", "asbmb")
#anything before or after wiley will be removed
dat$publisher <- str_replace_all(dat$publisher, ".*wiley.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, ".*elsevier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, ".*pnas.*", "pnas")
dat$publisher <- str_replace_all(dat$publisher, ".*royal college of psychiatrists.*", "royal college of psychiatrists")
dat$publisher <- str_replace_all(dat$publisher, ".*jove.*", "jove")
dat$publisher <- str_replace_all(dat$publisher, ".*faseb.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, ".*?company of biologists.*", "the company of biologists")
#anything after the name will be removed
dat$publisher <- str_replace_all(dat$publisher, "sage.*", "sage")
dat$publisher <- str_replace_all(dat$publisher, "wolters kluwer.*", "wolters kluwer")
dat$publisher <- str_replace_all(dat$publisher, "springer.*", "springer")
dat$publisher <- str_replace_all(dat$publisher, "nature.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "bmj.*", "bmj")
dat$publisher <- str_replace_all(dat$publisher, "cold spring harbor.*", "cold spring harbor")
dat$publisher <- str_replace_all(dat$publisher, "acs.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "asbmb.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "dartmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "cambridge.*", "cambridge")
dat$publisher <- str_replace_all(dat$publisher, "oxford.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, "plos.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, "rsc.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "portland.*", "portland")
dat$publisher <- str_replace_all(dat$publisher, "&", "and")
dat$publisher <- str_replace_all(dat$publisher, "taylor and francis.*", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "bentham.*", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "national academy of sciences.*", "national academy of sciences")
dat$publisher <- str_replace_all(dat$publisher, "camdus.*", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "cenveo.*", "cenveo")
dat$publisher <- str_replace_all(dat$publisher, "mary ann liebert.*", "mary ann liebert")
dat$publisher <- str_replace_all(dat$publisher, "impact.*", "impact")
dat$publisher <- str_replace_all(dat$publisher, "frontiers.*", "frontiers")
dat$publisher <- str_replace_all(dat$publisher, "future medicine.*", "future science")
dat$publisher <- str_replace_all(dat$publisher, "hindawi.*", "hindawi")
dat$publisher <- str_replace_all(dat$publisher, "informa healthcare.*", "informa healthcare")
dat$publisher <- str_replace_all(dat$publisher, "mit press.*", "mit press")
dat$publisher <- str_replace_all(dat$publisher, "humana press.*", "humana press")
dat$publisher <- str_replace_all(dat$publisher, "humana pubmed.*", "pubmed")
dat$publisher <- str_replace_all(dat$publisher, "npg.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "oup.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, ".*royal society.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "public library of science.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for biochemistry and molecular biology.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "federation of american societies for experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher,"federation of american society of experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, "american chemical society.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "tandf", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "international union of crystallography.*", "iucr")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "biomed central.*", "bmc")
dat$publisher <- str_replace_all(dat$publisher, "british medical journal", "bmj")
dat$publisher <- str_replace_all(dat$publisher, ".*american society of microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "of general microbiology", "for general microbiology")
dat$publisher <- str_replace_all(dat$publisher, "of leukocyte", "for leukocyte")
dat$publisher <- str_replace_all(dat$publisher, "publisher society", "society")
dat$publisher <- str_replace_all(dat$publisher, "company of biologist^s", "company of biologists")
dat$publisher <- str_replace_all(dat$publisher, "american psychiatric publishing", "american psychiatric association")
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), sd = sd(cost), n=n()) %>% arrange(desc(mean))
dat$publisher <- str_remove_all(dat$publisher, "\r\n")
dat$publisher <- str_trim(dat$publisher, side = "both")
dat$publisher <- str_remove_all(dat$publisher, "the ")
levels(as.factor(dat$publisher))
str_replace_all(c("company of biologists", "company of biologist"), "company of biologist^s", "company of biologists")
str_replace_all(c("company of biologists", "company of biologist"), "company of biologist[\\b^s]", "company of biologists")
str_replace_all(c("company of biologists", "company of biologist"), "company of biologist$", "company of biologists")
library(tidyverse)
library(readxl)
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx")
str(dat)
colnames(dat) <- gsub("/", "_", colnames(dat))
colnames(dat) <- gsub(" .*", "", colnames(dat))
colnames(dat) <-tolower(colnames(dat))
dat %>% arrange(desc(cost)) %>% head()
dat %>% summary(cost)
dat[!complete.cases(dat$journal),]
dat[!complete.cases(dat),]
dat <- dat %>% filter(journal != "NA")
dat %>% arrange(cost) %>% filter(publisher == "American Society for Nutrition")
dat %>% summarize(sd = sd(cost), mean = mean(cost))
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- tolower(dat$publisher)
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- str_replace_all(dat$publisher, "darmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "wliey.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, "endrocrine", "endocrine")
dat$publisher <- str_replace_all(dat$publisher, "biolgists", "biologists")
dat$publisher <- str_replace_all(dat$publisher, "socety", "society")
dat$publisher <- str_replace_all(dat$publisher, "genermal", "general")
dat$publisher <- str_replace_all(dat$publisher, "neuro\\s?science[s]?", "neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "elseveier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, "of neuroscience", "for neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "habour", "harbor")
dat$publisher <- str_replace_all(dat$publisher, "landes biosciences", "landes bioscience")
dat$publisher <- str_replace_all(dat$publisher, "biolgy", "biology")
dat$publisher <- str_replace_all(dat$publisher, "soc\\b", "society")
dat$publisher <- str_replace_all(dat$publisher, "hamatology|haematology", "hematology")
dat$publisher <- str_replace_all(dat$publisher, "cadmus", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "benthan", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "berhahn books", "berghahn")
dat$publisher <- str_replace_all(dat$publisher, "byophysical", "biophysical")
dat$publisher <- str_replace_all(dat$publisher, "asbmc.*", "asbmb")
#anything before or after wiley will be removed
dat$publisher <- str_replace_all(dat$publisher, ".*wiley.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, ".*elsevier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, ".*pnas.*", "pnas")
dat$publisher <- str_replace_all(dat$publisher, ".*royal college of psychiatrists.*", "royal college of psychiatrists")
dat$publisher <- str_replace_all(dat$publisher, ".*jove.*", "jove")
dat$publisher <- str_replace_all(dat$publisher, ".*faseb.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, ".*?company of biologists.*", "the company of biologists")
#anything after the name will be removed
dat$publisher <- str_replace_all(dat$publisher, "sage.*", "sage")
dat$publisher <- str_replace_all(dat$publisher, "wolters kluwer.*", "wolters kluwer")
dat$publisher <- str_replace_all(dat$publisher, "springer.*", "springer")
dat$publisher <- str_replace_all(dat$publisher, "nature.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "bmj.*", "bmj")
dat$publisher <- str_replace_all(dat$publisher, "cold spring harbor.*", "cold spring harbor")
dat$publisher <- str_replace_all(dat$publisher, "acs.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "asbmb.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "dartmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "cambridge.*", "cambridge")
dat$publisher <- str_replace_all(dat$publisher, "oxford.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, "plos.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, "rsc.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "portland.*", "portland")
dat$publisher <- str_replace_all(dat$publisher, "&", "and")
dat$publisher <- str_replace_all(dat$publisher, "taylor and francis.*", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "bentham.*", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "national academy of sciences.*", "national academy of sciences")
dat$publisher <- str_replace_all(dat$publisher, "camdus.*", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "cenveo.*", "cenveo")
dat$publisher <- str_replace_all(dat$publisher, "mary ann liebert.*", "mary ann liebert")
dat$publisher <- str_replace_all(dat$publisher, "impact.*", "impact")
dat$publisher <- str_replace_all(dat$publisher, "frontiers.*", "frontiers")
dat$publisher <- str_replace_all(dat$publisher, "future medicine.*", "future science")
dat$publisher <- str_replace_all(dat$publisher, "hindawi.*", "hindawi")
dat$publisher <- str_replace_all(dat$publisher, "informa healthcare.*", "informa healthcare")
dat$publisher <- str_replace_all(dat$publisher, "mit press.*", "mit press")
dat$publisher <- str_replace_all(dat$publisher, "humana press.*", "humana press")
dat$publisher <- str_replace_all(dat$publisher, "humana pubmed.*", "pubmed")
dat$publisher <- str_replace_all(dat$publisher, "npg.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "oup.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, ".*royal society.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "public library of science.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for biochemistry and molecular biology.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "federation of american societies for experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher,"federation of american society of experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, "american chemical society.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "tandf", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "international union of crystallography.*", "iucr")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "biomed central.*", "bmc")
dat$publisher <- str_replace_all(dat$publisher, "british medical journal", "bmj")
dat$publisher <- str_replace_all(dat$publisher, ".*american society of microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "of general microbiology", "for general microbiology")
dat$publisher <- str_replace_all(dat$publisher, "of leukocyte", "for leukocyte")
dat$publisher <- str_replace_all(dat$publisher, "publisher society", "society")
dat$publisher <- str_replace_all(dat$publisher, "company of biologist$", "company of biologists")
dat$publisher <- str_replace_all(dat$publisher, "american psychiatric publishing", "american psychiatric association")
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), sd = sd(cost), n=n()) %>% arrange(desc(mean))
dat$publisher <- str_remove_all(dat$publisher, "\r\n")
dat$publisher <- str_trim(dat$publisher, side = "both")
dat$publisher <- str_remove_all(dat$publisher, "the ")
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
library(tidyverse)
library(readxl)
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx")
str(dat)
colnames(dat) <- gsub("/", "_", colnames(dat))
colnames(dat) <- gsub(" .*", "", colnames(dat))
colnames(dat) <-tolower(colnames(dat))
dat %>% arrange(desc(cost)) %>% head()
dat %>% summary(cost)
dat[!complete.cases(dat$journal),]
dat[!complete.cases(dat),]
dat <- dat %>% filter(journal != "NA")
dat %>% arrange(cost) %>% filter(publisher == "American Society for Nutrition")
dat %>% summarize(sd = sd(cost), mean = mean(cost))
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- tolower(dat$publisher)
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- str_replace_all(dat$publisher, "darmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "wliey.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, "endrocrine", "endocrine")
dat$publisher <- str_replace_all(dat$publisher, "biolgists", "biologists")
dat$publisher <- str_replace_all(dat$publisher, "socety", "society")
dat$publisher <- str_replace_all(dat$publisher, "genermal", "general")
dat$publisher <- str_replace_all(dat$publisher, "neuro\\s?science[s]?", "neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "elseveier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, "of neuroscience", "for neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "habour", "harbor")
dat$publisher <- str_replace_all(dat$publisher, "landes biosciences", "landes bioscience")
dat$publisher <- str_replace_all(dat$publisher, "biolgy", "biology")
dat$publisher <- str_replace_all(dat$publisher, "soc\\b", "society")
dat$publisher <- str_replace_all(dat$publisher, "hamatology|haematology", "hematology")
dat$publisher <- str_replace_all(dat$publisher, "cadmus", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "benthan", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "berhahn books", "berghahn")
dat$publisher <- str_replace_all(dat$publisher, "byophysical", "biophysical")
dat$publisher <- str_replace_all(dat$publisher, "asbmc.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "endocrinolog", "endocrinology")
#anything before or after wiley will be removed
dat$publisher <- str_replace_all(dat$publisher, ".*wiley.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, ".*elsevier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, ".*pnas.*", "pnas")
dat$publisher <- str_replace_all(dat$publisher, ".*royal college of psychiatrists.*", "royal college of psychiatrists")
dat$publisher <- str_replace_all(dat$publisher, ".*jove.*", "jove")
dat$publisher <- str_replace_all(dat$publisher, ".*faseb.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, ".*?company of biologists.*", "the company of biologists")
#anything after the name will be removed
dat$publisher <- str_replace_all(dat$publisher, "sage.*", "sage")
dat$publisher <- str_replace_all(dat$publisher, "wolters kluwer.*", "wolters kluwer")
dat$publisher <- str_replace_all(dat$publisher, "springer.*", "springer")
dat$publisher <- str_replace_all(dat$publisher, "nature.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "bmj.*", "bmj")
dat$publisher <- str_replace_all(dat$publisher, "cold spring harbor.*", "cold spring harbor")
dat$publisher <- str_replace_all(dat$publisher, "acs.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "asbmb.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "dartmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "cambridge.*", "cambridge")
dat$publisher <- str_replace_all(dat$publisher, "oxford.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, "plos.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, "rsc.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "portland.*", "portland")
dat$publisher <- str_replace_all(dat$publisher, "&", "and")
dat$publisher <- str_replace_all(dat$publisher, "taylor and francis.*", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "bentham.*", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "national academy of sciences.*", "national academy of sciences")
dat$publisher <- str_replace_all(dat$publisher, "camdus.*", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "cenveo.*", "cenveo")
dat$publisher <- str_replace_all(dat$publisher, "mary ann liebert.*", "mary ann liebert")
dat$publisher <- str_replace_all(dat$publisher, "impact.*", "impact")
dat$publisher <- str_replace_all(dat$publisher, "frontiers.*", "frontiers")
dat$publisher <- str_replace_all(dat$publisher, "future medicine.*", "future science")
dat$publisher <- str_replace_all(dat$publisher, "hindawi.*", "hindawi")
dat$publisher <- str_replace_all(dat$publisher, "informa healthcare.*", "informa healthcare")
dat$publisher <- str_replace_all(dat$publisher, "mit press.*", "mit press")
dat$publisher <- str_replace_all(dat$publisher, "humana press.*", "humana press")
dat$publisher <- str_replace_all(dat$publisher, "pubmed.*", "pubmed")
dat$publisher <- str_replace_all(dat$publisher, "npg.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "oup.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, ".*royal society.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "public library of science.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for biochemistry and molecular biology.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "federation of american societies for experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher,"federation of american society of experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, "american chemical society.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "tandf", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "international union of crystallography.*", "iucr")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "biomed central.*", "bmc")
dat$publisher <- str_replace_all(dat$publisher, "british medical journal", "bmj")
dat$publisher <- str_replace_all(dat$publisher, ".*american society of microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "of general microbiology", "for general microbiology")
dat$publisher <- str_replace_all(dat$publisher, "of leukocyte", "for leukocyte")
dat$publisher <- str_replace_all(dat$publisher, "publisher society", "society")
dat$publisher <- str_replace_all(dat$publisher, "company of biologist$", "company of biologists")
dat$publisher <- str_replace_all(dat$publisher, "american psychiatric publishing", "american psychiatric association")
dat$publisher <- str_replace_all(dat$publisher, "institute of physics", "iop publishing")
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), sd = sd(cost), n=n()) %>% arrange(desc(mean))
dat$publisher <- str_remove_all(dat$publisher, "\r\n")
dat$publisher <- str_trim(dat$publisher, side = "both")
dat$publisher <- str_remove_all(dat$publisher, "the ")
levels(as.factor(dat$publisher))
dat %>% group_by(publisher) %>% mutate(mean = mean(cost)) %>% arrange(desc(mean)) %>% select(publisher, mean) %>% unique()
dat$journal <-  tolower(dat$journal)
dat %>% group_by(journal) %>% mutate(mean = mean(cost)) %>% arrange(desc(cost)) %>% select(journal, publisher, mean)
dat %>% group_by(publisher) %>% mutate(mean = mean(cost)) %>% arrange(desc(mean)) %>% select(publisher, mean) %>% unique()
dat %>% group_by(journal) %>% mutate(mean = mean(cost)) %>% arrange(desc(cost)) %>% select(journal, mean) %>% unique()
dat %>% filter(publisher == "elsevier") %>% summarize(median_cad = median(cost)*1.79)
View(dat)
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), sd = sd(cost), n=n()) %>% arrange(desc(mean))
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), n=n()) %>% arrange(desc(n))
dat %>% group_by(publisher) %>% summarize(n=n()) %>% arrange(desc(n)) %>% .[1:3,] %>% summarize(mean = mean(cost))
dat %>% group_by(publisher) %>% summarize(n=n(), cost = cost) %>% arrange(desc(n)) %>% .[1:3,] %>% summarize(mean = mean(cost))
dat %>% filter(publisher == "elsevier", publisher == "plos", publisher == "wiley") %>% summarize(mean = mean(cost))
dat %>% filter(publisher == "elsevier"| publisher == "plos"| publisher == "wiley") %>% summarize(mean = mean(cost))
dat$journal <-  tolower(dat$journal)
dat %>% group_by(journal) %>% mutate(mean = mean(cost)) %>% arrange(desc(cost)) %>% select(journal, mean) %>% unique()
dat %>% group_by(journal) %>% summarize(mean = mean(cost), n=n()) %>% arrange(desc(n))
grepl(dat$journal, "plos")
grepl("plos", dat$journal)
filter(dat, grepl("plos", dat$journal))
filter(dat, grepl("plos[\\sone|\\\s1|one]", dat$journal))
filter(dat, grepl("plos[\\sone|\\s1|one]", dat$journal))
filter(dat, grepl("plos[\\sone][\\s1][one]", dat$journal))
filter(dat, grepl("plos\\s?[[one]1]", dat$journal))
filter(dat, grepl("plos\\s?one", dat$journal))
filter(dat, grepl("plos\\s.one", dat$journal))
filter(dat, grepl("plos[\\s]?one", dat$journal))
filter(dat, grepl("plos//s", dat$journal))
filter(dat, grepl("plos[[:space:]]?", dat$journal))
filter(dat, grepl("plos[[:space:]]?one", dat$journal))
filter(dat, grepl("plos[[:space:]]?[one|1]", dat$journal))
filter(dat, grepl("plos[[:space:]]?[(one)|1]", dat$journal))
filter(dat, grepl("plos[[:space:]]?one|1", dat$journal))
filter(dat, grepl("plos[[:space:]]?1?one?", dat$journal))
filter(dat, grepl("plos[[:space:]]?[[:digit:]]?one?", dat$journal))
filter(dat, grepl("plos[[:space:]]?[one]?", dat$journal))
filter(dat, grepl("plos[[:space:]]?(one)?", dat$journal))
filter(dat, grepl("plos[[:space:]]?one?", dat$journal))
filter(dat, grepl("plos[[:space:]]?one?1?", dat$journal))
filter(dat, grepl("plos[[:space:]1]?one?1?", dat$journal))
filter(dat, grepl("plos[[:space:]1]?one?", dat$journal))
filter(dat, grepl("plos[[:space:]1?]?one?", dat$journal))
filter(dat, grepl("plos[[:space:]?1?]?one?", dat$journal))
filter(dat, grepl("plos[[:space:]]?one?|1?", dat$journal))
filter(dat, grepl("plos[[:space:]]?one?", dat$journal))
filter(dat, grepl("plos 1", dat$journal))
filter(dat, grepl("plos one|1", dat$journal))
filter(dat, grepl("plos[[:space:]]?(one|1)", dat$journal))
filter(dat, grepl("plos[[:space:]]?(one|1)", dat$journal)) %>% nrow(.)
dat %>% group_by(journal) %>% summarize(mean = mean(cost), n=n()) %>% arrange(desc(n))
filter(dat, grepl("plos", dat$journal)) %>% select(journal)
filter(dat, grepl("public", dat$journal)) %>% select(journal)
filter(dat, grepl("p(los[[:space:]]?(one|1)|ublic library of science one)", dat$journal)) %>% nrow(.)
filter(dat, grepl("one$", dat$journal)) %>% select(journal)
filter(dat, grepl("//bone$", dat$journal)) %>% select(journal)
filter(dat, grepl("\\bone$", dat$journal)) %>% select(journal)
filter(dat, grepl("\\b(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("plos\\b?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("\\b?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("\\s?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("^b\\s?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("[^b]\\s?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("[^b]\\s?(1|one)$", dat$journal)) %>% select(journal)%>% nrow(.)
filter(dat, grepl("[^b]\\s?(1|one)$", dat$journal)) %>% select(journal)%>% nrow(.)
filter(dat, grepl("[^b]\\s?(1|one)$", dat$journal)) %>% select(journal)
filter(dat, grepl("p(los[[:space:]]+(one|1)|ublic library of science one)", dat$journal)) %>% nrow(.)
filter(dat, grepl("p(los[[:space:]]*(one|1)|ublic library of science one)", dat$journal)) %>% nrow(.)
filter(dat, grepl("plos", dat$journal)) %>% select(journal)
package.dependencies("knitr")
tools::package.dependencies("knitr")
package_dependencies("knitr")
tools::package_dependencies("knitr")
tools::package_dependencies("rmarkdown")
(1826-45.9)/807
unique(dat$publisher)
length(unique(dat$publisher))
filter(dat, grepl("plos", dat$journal)) %>% select(journal)
library(tidyverse)
library(readxl)
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx")
str(dat)
View(dat)
colnames(dat) <- gsub("/", "_", colnames(dat))
colnames(dat) <- gsub(" .*", "", colnames(dat))
colnames(dat) <-tolower(colnames(dat))
dat %>% arrange(cost) %>% head()
dat %>% arrange(cost) %>% filter(publisher == "American Society for Nutrition")
dat %>% summarize(sd = sd(cost), mean = mean(cost))
(1826-45.9)/807
dat %>% arrange(desc(cost)) %>% head()
dat[!complete.cases(dat$journal),]
dat[!complete.cases(dat),]
dat <- dat %>% filter(journal != "NA")
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat$publisher <- tolower(dat$publisher)
length(levels(as.factor(dat$publisher)))
dat$publisher <- str_replace_all(dat$publisher, "darmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "wliey.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, "endrocrine", "endocrine")
dat$publisher <- str_replace_all(dat$publisher, "biolgists", "biologists")
dat$publisher <- str_replace_all(dat$publisher, "socety", "society")
dat$publisher <- str_replace_all(dat$publisher, "genermal", "general")
dat$publisher <- str_replace_all(dat$publisher, "neuro\\s?science[s]?", "neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "elseveier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, "of neuroscience", "for neuroscience")
dat$publisher <- str_replace_all(dat$publisher, "habour", "harbor")
dat$publisher <- str_replace_all(dat$publisher, "landes biosciences", "landes bioscience")
dat$publisher <- str_replace_all(dat$publisher, "biolgy", "biology")
dat$publisher <- str_replace_all(dat$publisher, "soc\\b", "society")
dat$publisher <- str_replace_all(dat$publisher, "hamatology|haematology", "hematology")
dat$publisher <- str_replace_all(dat$publisher, "cadmus", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "benthan", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "berhahn books", "berghahn")
dat$publisher <- str_replace_all(dat$publisher, "byophysical", "biophysical")
dat$publisher <- str_replace_all(dat$publisher, "asbmc.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "endocrinolog", "endocrinology")
dat$publisher <- str_replace_all(dat$publisher, "clearace", "clearance")
#anything before or after wiley will be removed
dat$publisher <- str_replace_all(dat$publisher, ".*wiley.*", "wiley")
dat$publisher <- str_replace_all(dat$publisher, ".*elsevier.*", "elsevier")
dat$publisher <- str_replace_all(dat$publisher, ".*pnas.*", "pnas")
dat$publisher <- str_replace_all(dat$publisher, ".*royal college of psychiatrists.*", "royal college of psychiatrists")
dat$publisher <- str_replace_all(dat$publisher, ".*jove.*", "jove")
dat$publisher <- str_replace_all(dat$publisher, ".*faseb.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, ".*?company of biologists.*", "the company of biologists")
#anything after the name will be removed
dat$publisher <- str_replace_all(dat$publisher, "sage.*", "sage")
dat$publisher <- str_replace_all(dat$publisher, "wolters kluwer.*", "wolters kluwer")
dat$publisher <- str_replace_all(dat$publisher, "springer.*", "springer")
dat$publisher <- str_replace_all(dat$publisher, "nature.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "bmj.*", "bmj")
dat$publisher <- str_replace_all(dat$publisher, "cold spring harbor.*", "cold spring harbor")
dat$publisher <- str_replace_all(dat$publisher, "acs.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "asbmb.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "dartmouth.*", "dartmouth")
dat$publisher <- str_replace_all(dat$publisher, "cambridge.*", "cambridge")
dat$publisher <- str_replace_all(dat$publisher, "oxford.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, "plos.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, "rsc.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "portland.*", "portland")
dat$publisher <- str_replace_all(dat$publisher, "&", "and")
dat$publisher <- str_replace_all(dat$publisher, "taylor and francis.*", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "bentham.*", "bentham")
dat$publisher <- str_replace_all(dat$publisher, "national academy of sciences.*", "national academy of sciences")
dat$publisher <- str_replace_all(dat$publisher, "camdus.*", "camdus")
dat$publisher <- str_replace_all(dat$publisher, "cenveo.*", "cenveo")
dat$publisher <- str_replace_all(dat$publisher, "mary ann liebert.*", "mary ann liebert")
dat$publisher <- str_replace_all(dat$publisher, "impact.*", "impact")
dat$publisher <- str_replace_all(dat$publisher, "frontiers.*", "frontiers")
dat$publisher <- str_replace_all(dat$publisher, "future medicine.*", "future science")
dat$publisher <- str_replace_all(dat$publisher, "hindawi.*", "hindawi")
dat$publisher <- str_replace_all(dat$publisher, "informa healthcare.*", "informa healthcare")
dat$publisher <- str_replace_all(dat$publisher, "mit press.*", "mit press")
dat$publisher <- str_replace_all(dat$publisher, "humana press.*", "humana press")
dat$publisher <- str_replace_all(dat$publisher, "pubmed.*", "pubmed")
dat$publisher <- str_replace_all(dat$publisher, "npg.*", "nature")
dat$publisher <- str_replace_all(dat$publisher, "oup.*", "oxford")
dat$publisher <- str_replace_all(dat$publisher, ".*royal society.*", "rsc")
dat$publisher <- str_replace_all(dat$publisher, "public library of science.*", "plos")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for biochemistry and molecular biology.*", "asbmb")
dat$publisher <- str_replace_all(dat$publisher, "federation of american societies for experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher,"federation of american society of experimental biology.*", "faseb")
dat$publisher <- str_replace_all(dat$publisher, "american chemical society.*", "acs")
dat$publisher <- str_replace_all(dat$publisher, "tandf", "taylor and francis")
dat$publisher <- str_replace_all(dat$publisher, "international union of crystallography.*", "iucr")
dat$publisher <- str_replace_all(dat$publisher, ".*american society for microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "biomed central.*", "bmc")
dat$publisher <- str_replace_all(dat$publisher, "british medical journal", "bmj")
dat$publisher <- str_replace_all(dat$publisher, ".*american society of microbiology.*", "asm")
dat$publisher <- str_replace_all(dat$publisher, "of general microbiology", "for general microbiology")
dat$publisher <- str_replace_all(dat$publisher, "of leukocyte", "for leukocyte")
dat$publisher <- str_replace_all(dat$publisher, "publisher society", "society")
dat$publisher <- str_replace_all(dat$publisher, "company of biologist$", "company of biologists")
dat$publisher <- str_replace_all(dat$publisher, "american psychiatric publishing", "american psychiatric association")
dat$publisher <- str_replace_all(dat$publisher, "institute of physics", "iop publishing")
dat$publisher <- str_remove_all(dat$publisher, "\r\n")
dat$publisher <- str_trim(dat$publisher, side = "both")
dat$publisher <- str_remove_all(dat$publisher, "the ")
levels(as.factor(dat$publisher))
length(levels(as.factor(dat$publisher)))
dat %>% group_by(publisher) %>% summarize(mean = mean(cost), n=n()) %>% arrange(desc(n))
dat %>% filter(publisher == "elsevier"| publisher == "plos"| publisher == "wiley") %>% summarize(mean = mean(cost))
filter(dat, grepl("plos", dat$journal)) %>% select(journal)
filter(dat, grepl("plos", dat$journal)) %>% select(journal) %>% tail()
dat$journal <- tolower(dat$journal)
filter(dat, grepl("plos", dat$journal)) %>% select(journal) %>% tail()
filter(dat, grepl("public", dat$journal)) %>% select(journal) %>% tail()
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx") %>% select(-Article title)
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx") %>% select(-'Article title')
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx") %>% select(-"Article title")
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx") %>% select(-`Article title`)
str(dat)
install.packages("amssymb")
dat <- read_xlsx("data/University returns_for_figshare_FINAL.xlsx")
str(dat)
